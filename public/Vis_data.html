<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temperaturgraf</title>

    <!-- Firebase SDK -->
    <!-- Legger til Firebase SDK for app og database -->
    <script src="https://www.gstatic.com/firebasejs/9.1.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.2/firebase-database.js"></script>

    <!-- Plotly.js for grafene -->
    <!-- Legger til Plotly.js via CDN -->
    <script src="https://cdn.jsdelivr.net/npm/plotly.js"></script>
</head>
<body>
    <h1>Temperaturgraf</h1>
    <!-- Div for å vise grafen -->
    <div id="temperatureChart" style="height: 400px; width: 600px;"></div>

    <script>
        // Firebase-konfigurasjon
        const firebaseConfig = {
            apiKey: "AIzaSyCUKEazdRZzpRAC9hUmN_-aAzJiYR3C554",  // Bytt ut med din API-nøkkel
            authDomain: "bikube-monitor.firebaseapp.com",  // Bytt ut med ditt prosjekt-ID
            databaseURL: "https://bikube-monitor-default-rtdb.europe-west1.firebasedatabase.app",  // Bytt ut med din database-URL
            projectId: "bikube-monitor",
            storageBucket: "bikube-monitor.firebasestorage.app",
            messagingSenderId: "72432466941",
            appId: "1:72432466941:web:9227ec554e91167f9a3794",
            measurementId: "G-JZZRQ25XR3"
        };

        // Initialiser Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        
        // Hent data fra Firebase-databasen
        database.ref('temperatures').once('value').then(function(snapshot) {
            const data = snapshot.val();  // Hent data fra Firebase
            const xValues = [];  // Tidspunkt (eller indekser)
            const yValues = [];  // Temperaturdata

            let i = 0;  // Bruk en teller for x-verdiene
            for (const key in data) {
                if (data.hasOwnProperty(key)) {
                    xValues.push(i);  // Her kan du bruke tidsstempel eller annet ID som x-verdi
                    yValues.push(data[key].temperature);  // Temperaturverdiene fra Firebase
                    i++;
                }
            }

            // Vis grafen
            plotGraph(xValues, yValues);
        });

        // Funksjon for å vise grafen med Plotly.js
        function plotGraph(xValues, yValues) {
            const data = [{
                x: xValues,
                y: yValues,
                mode: "lines",
                type: "scatter"
            }];

            const layout = {
                xaxis: {title: "Tid (dager)", range: [0, xValues.length]},  // Juster tidsskalaen
                yaxis: {title: "Temperatur (°C)", range: [20, 50]},  // Juster temperaturintervallet
                title: "Temperaturmålinger"
            };

            Plotly.newPlot("temperatureChart", data, layout);
        }
    </script>
</body>
</html>
